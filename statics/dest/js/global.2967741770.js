!function(){"use strict";function e(e){return function(){return{request:function(t){return t.url=e+t.url,t}}}}function t(e,t){return function(n,r){if("development"===CONFIG.env)alert(n.message),e.error.apply(e,arguments);else{var o=t.get("$http");o.post("/exception?httplog=false",{message:n.message,stack:n.stack,cause:r})}}}function n(e,t,n,r){TIMING.end("js"),r=r("app.run");var o=function(){var t=angular.extend({timeline:TIMING.getLogs(),view:{width:n.screen.width,height:n.screen.height}},n.performance);e.post("/statistics",t)};if(n.onload=function(){o()},"development"===CONFIG.env){var i=1e4,s=function(){var e=0,n=function(t){if(t.data().hasOwnProperty("$scope")){var r=t.data().$scope.$$watchers;r&&(e+=r.length)}angular.forEach(t.children(),function(e){n(angular.element(e))})};n(angular.element(document.body)),r("watcher total:"+e),t(function(){s()},i)};t(function(){s()},s)}}function r(e,t,n,r,o){function i(){var t=angular.element(angular.element("#loginDialog").html()),o=e.$new(!0);angular.extend(o,{status:"show",type:"login",modal:!0}),n(t)(o),r.append(t),o.submit=function(){a(o)},angular.forEach(["account","password"],function(e){o.$watch(e,function(){o.error=""})})}function s(){o.logout()}function a(e){if(!e.account||!e.password)return void(e.error="账号和密码均不能为空");e.submiting=!0,e.msg="正在提交，请稍候...";var t=o[e.type];t&&t(e.account,e.password).success(function(){e.destroy()}).error(function(t){e.error=t.msg||t.error||"未知异常",e.submiting=!1,e.msg=""})}function u(){c.session.status="loading",o.session().then(function(e){angular.extend(c.session,e),c.session.status="success"},function(e){c.session.error=e,c.session.status="fail"})}var c=this;c.login=i,c.logout=s,c.session={},e.$on("user",function(){u()}),u()}var o=["LocalStorageModule","jt.service.debug","jt.service.httpLog","jt.service.user","jt.directive.widget"],i=angular.module("jtApp",o);i.addRequires=function(e){angular.isArray(e)||(e=[e]);var t=i.requires;return angular.forEach(e,function(e){~t.indexOf(e)||t.push(e)}),this},i.config(["localStorageServiceProvider",function(e){e.prefix="jt"}]).config(["$httpProvider",function(t){t.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";var n=CONFIG.appUrlPrefix;if(n){var r=e(n);t.interceptors.push(r)}t.interceptors.push("httpLog")}]).config(["$provide",function(e){var n=["$log","$injector",t];e.decorator("$exceptionHandler",n)}]),i.run(["$http","$timeout","$window","debug",n]),i.controller("AppController",r),r.$inject=["$scope","$http","$compile","$element","user"]}(this);